<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 0.27.2">


<link href="css/style.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="js/doc.js"></script>
<script type="text/javascript">
  CrystalDoc.base_path = "";
</script>

  <meta id="repository-name" content="github.com/dscottboggs/subtitles.cr">
  <title>README - github.com/dscottboggs/subtitles.cr</title>
</head>
<body>

<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="repository-links">
      <a href="index.html">README</a>
    </div>
  </div>

  <div class="search-results" class="hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/MillisecondsSpanConverter" data-name="millisecondsspanconverter">
      <a href="MillisecondsSpanConverter.html">MillisecondsSpanConverter</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Sanitizer" data-name="sanitizer">
      <a href="Sanitizer.html">Sanitizer</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/SanitizeString" data-name="sanitizestring">
      <a href="SanitizeString.html">SanitizeString</a>
      
    </li>
  
  <li class="parent " data-id="github.com/dscottboggs/subtitles.cr/SanitizeStringHash" data-name="sanitizestringhash">
      <a href="SanitizeStringHash.html">SanitizeStringHash</a>
      
        <ul>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/SanitizeStringHash/StringHash" data-name="sanitizestringhash::stringhash">
      <a href="SanitizeStringHash/StringHash.html">StringHash</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="github.com/dscottboggs/subtitles.cr/Subtitles" data-name="subtitles">
      <a href="Subtitles.html">Subtitles</a>
      
        <ul>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/ASS" data-name="subtitles::ass">
      <a href="Subtitles/ASS.html">ASS</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Caption" data-name="subtitles::caption">
      <a href="Subtitles/Caption.html">Caption</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Captions" data-name="subtitles::captions">
      <a href="Subtitles/Captions.html">Captions</a>
      
    </li>
  
  <li class="parent " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Config" data-name="subtitles::config">
      <a href="Subtitles/Config.html">Config</a>
      
        <ul>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Config/Arguments" data-name="subtitles::config::arguments">
      <a href="Subtitles/Config/Arguments.html">Arguments</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Config/Default" data-name="subtitles::config::default">
      <a href="Subtitles/Config/Default.html">Default</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Format" data-name="subtitles::format">
      <a href="Subtitles/Format.html">Format</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/JSON" data-name="subtitles::json">
      <a href="Subtitles/JSON.html">JSON</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/LRC" data-name="subtitles::lrc">
      <a href="Subtitles/LRC.html">LRC</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Meta" data-name="subtitles::meta">
      <a href="Subtitles/Meta.html">Meta</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/SBV" data-name="subtitles::sbv">
      <a href="Subtitles/SBV.html">SBV</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/SMI" data-name="subtitles::smi">
      <a href="Subtitles/SMI.html">SMI</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/SRT" data-name="subtitles::srt">
      <a href="Subtitles/SRT.html">SRT</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/SSA" data-name="subtitles::ssa">
      <a href="Subtitles/SSA.html">SSA</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Style" data-name="subtitles::style">
      <a href="Subtitles/Style.html">Style</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/SUB" data-name="subtitles::sub">
      <a href="Subtitles/SUB.html">SUB</a>
      
    </li>
  
  <li class="parent " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Substation" data-name="subtitles::substation">
      <a href="Subtitles/Substation.html">Substation</a>
      
        <ul>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Substation/DialogueBeforeFormat" data-name="subtitles::substation::dialoguebeforeformat">
      <a href="Subtitles/Substation/DialogueBeforeFormat.html">DialogueBeforeFormat</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Substation/Regexes" data-name="subtitles::substation::regexes">
      <a href="Subtitles/Substation/Regexes.html">Regexes</a>
      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/Substation/StyleBeforeFormat" data-name="subtitles::substation::stylebeforeformat">
      <a href="Subtitles/Substation/StyleBeforeFormat.html">StyleBeforeFormat</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="github.com/dscottboggs/subtitles.cr/Subtitles/VTT" data-name="subtitles::vtt">
      <a href="Subtitles/VTT.html">VTT</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1>subtitles.cr</h1>

<p>Convert between various subtitle file-formats. Based on
<a href="https://github.com/papnkukn/subsrt" target="_blank">papnkukn/subsrt</a>. Currently converts
between ASS, SSA, SRT, and JSON formats, more formats planned.</p>

<p><strong><a href="https://dscottboggs.github.io/subtitles.cr/" target="_blank">API documentation</a></strong></p>

<h2>Installation</h2>

<h3>As a library</h3>

<ol><li>Add the dependency to your <code>shard.yml</code>:</li></ol>

<pre><code class="language-yaml">dependencies:
  subtitles.cr:
    github: dscottboggs/subtitles.cr
</code></pre>

<ol><li>Run <code>shards install</code></li></ol>

<h3>As a command line interface</h3>

<p>Download a release binary for your OS from the <a href="https://github.com/dscottboggs/subtitles.cr/releases" target="_blank">releases</a> section</p>

<h5><em>OR</em></h5>

<ol><li>Install <a href="https://crystal-lang.org/reference/installation/index.html" target="_blank">Crystal</a></li><li>Clone this repository</li><li>From a shell within the repository, run <code>shards install && crystal build --release -o/usr/local/bin/subtitles src/subtitles.cr</code></li></ol>

<h2>Usage</h2>

<h3>As a library</h3>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;subtitles&quot;</span>

<span class="c"># Read in the subtitle file to an intermediary format</span>
intermediary <span class="o">=</span> <span class="t">Subtitles</span>.parse filepath: <span class="s">&quot;/path/to/sub.srt&quot;</span>

<span class="c"># Convert to the desired format</span>
ass <span class="o">=</span> <span class="t">Subtitles</span><span class="t">::</span><span class="t">ASS</span>.<span class="k">new</span> intermediary

<span class="c"># Open the destination file</span>
<span class="t">File</span>.open <span class="s">&quot;/path/to/sub.srt&quot;</span>, mode: <span class="s">&quot;w&quot;</span> <span class="k">do</span> <span class="o">|</span>file<span class="o">|</span>
  <span class="c"># Copy in the data</span>
  <span class="t">IO</span>.copy ass, file
<span class="k">end</span>

<span class="c"># Alternatively, serve over HTTP:</span>
<span class="k">module</span> <span class="t">Middleware</span>
  <span class="k">def</span> <span class="m">call</span>(request : <span class="t">HTTP</span><span class="t">::</span><span class="t">Request</span>, response : <span class="t">HTTP</span><span class="t">::</span><span class="t">Server</span><span class="t">::</span><span class="t">Response</span>)
    <span class="c"># Obviously the above steps need applied here too.</span>
    <span class="t">IO</span>.copy ass, response
  <span class="k">end</span>
<span class="k">end</span></code></pre>

<h3>As a command-line utility</h3>

<h5>With actual filenames specified:</h5>

<pre><code class="language-shell">subtitles /path/to/original.subtitles /path/to/output.format</code></pre>

<p>The extension of the output file is important, as that's how the
application determines the filetype to output. The input file's type,
however, is detected based on its content, so it can be named anything.</p>

<h5>Piping and redirecting:</h5>

<p>If you wish, you can pipe the outut of this program into another,
or print it directly to your terminal. For example, the following
command will print the first 25 lines of a <code>.srt</code> subtitle file,
in JSON format:</p>

<pre><code class="language-shell">subtitles /path/to/original.srt --to json - | head -n25</code></pre>

<p>the only thing to note of importance here is that in lieu of looking for a
an output format in the output format filename, you must specify the <code>--to</code>
argument before the output file, and that <code>-</code> is used to represent <code>stdin</code>
<code>stdout</code> depending on the position</p>

<h2>Contributing</h2>

<ol><li>Fork it (&lt;https://github.com/dscottboggs/subtitles.cr/fork>)</li><li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li><li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li><li>Push to the branch (<code>git push origin my-new-feature</code>)</li><li>Create a new Pull Request</li></ol>

<p>Specs have already been written to verify various formats, so if someone else
gets the chance to implement the remaining formats before I do, follow these
steps:</p>

<ol><li>Write your parser as an implementation of the <code><a href="Subtitles/Format.html">Subtitles::Format</a></code> interface,
 and store it alongside the other formats in <code>src/format</code>.</li><li>when you're done, move the symbol for your format from the <code>PENDING</code> list to
 <code>READY</code> in <code>spec/spec_helper.cr</code>.</li><li>run <code>crystal spec</code></li></ol>

<p>For example, if you were implementing the <code>vtt</code> format, you'd store the
implementation in <code>src/format/vtt.cr</code>. In <code>spec/spec_helper</code>, <code>READY</code> would look
like the below snippet, and when you run <code>crystal spec</code> there should be no
failures or errors.</p>

<pre><code class="language-crystal"><span class="t">READY</span>   <span class="o">=</span> {<span class="n">:SRT</span>, <span class="n">:JSON</span>, <span class="n">:ASS</span>, <span class="n">:SSA</span>, <span class="n">:VTT</span>}</code></pre>

<p>Please note that build specs are only a regression test -- they take a snapshot
of the build process and verify that it remains the same. If you add or change a
snapshot, please also include a subtitle file for a public-domain movie or video
with a PR.</p>

<h2>Contributors</h2>

<ul><li><a href="https://github.com/dscottboggs" target="_blank">D. Scott Boggs</a> - creator and maintainer</li></ul>
</div>
</body>
</html>
